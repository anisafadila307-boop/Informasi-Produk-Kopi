<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Halaman Produk Biji Kopi Roasted</title>
<style>
body{
  font-family:"Arial",sans-serif;
  margin:0;
  padding:0;
  background:#faf7f3;
  color:#3e2723;
}
h1{text-align:center;color:#6b4226;}
p.desc{text-align:center;color:#5d4037;}
.card{
  background:white;
  padding:5px 20px 20px 20px;
  border-radius:10px;
  box-shadow:0 3px 10px rgba(0,0,0,0.1);
  margin:10px 0;
  transition:transform 0.15s,box-shadow 0.2s;
  max-width:400px;
  text-align:center;
  max-width: 320px;
  min-height: 400px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.container{
  display:grid !important;
  grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
  gap:20px !important;
  padding:20px !important;
}
.card img {
  display: block;
  border-radius: 10px;
  width: 100%;       /* atur ukuran tetap (misalnya 200px lebar) */
  height: 200px;       /*tinggi*/
  object-fit: cover;  /* potong gambar jika tidak proporsional */
  border-radius: 10px;
  margin: 10px 0;       /* jarak atas-bawah */
  overflow: hidden;     /* cegah tumpah */
}
.card:hover{
  transform:translateY(-3px);
  box-shadow:0 5px 15px rgba(0,0,0,0.15);
}
.btn-back{
  position:absolute;
  top:80px;
  left:30px;
  background:#6b4226;
  color:white;
  padding:8px 16px;
  border-radius:5px;
  text-decoration:none;
  font-size:14px;
  transition:background 0.2s;
}
.btn-back:hover{background:#4e342e;}
#produkList{max-width:800px;margin:30px auto;}
header{
  background-color:#7b4a27;
  color:#fff !important;
  padding:14px 24px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin:0;
}
header img{height:42px;margin-right:12px;}
header .left{display:flex;align-items:center;gap:0px;}
header h1{margin:0;font-size:18px;color:#fff !important;}
header .right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.btn-header {
  background: rgba(255, 255, 255, 0.15);
  border: none;
  color: #fff;
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s;
}

.btn-header:hover {
  background: rgba(255, 255, 255, 0.3);
}
.btn-edit,.btn-delete,.btn-detail{
  border:none;
  border-radius:6px;
  padding:6px 10px;
  cursor:pointer;
  color:#fff;
  font-size:13px;
  margin-right:6px;
}
.btn-edit{background-color:#8b5e3c;}
.btn-edit:hover{background-color:#a4714e;}
.btn-delete{background-color:#c0392b;}
.btn-delete:hover{background-color:#e74c3c;}
.btn-detail{background-color:#a0522d;}
.btn-detail:hover{background-color:#f4a460;}
.btn-group{margin-top:10px;}
</style>
</head>
<body>
<header>
  <div class="left">
    <img src="https://www.gochambers.com/wp-content/uploads/2022/08/logo-6.png" alt="Logo AEKI AICE"/>
    <h1>Portal Informasi Kopi Indonesia</h1>
  </div>

  <div class="right">
    <button class="btn-header" onclick="navigateToInput()">Input</button>
    <button class="btn-header" onclick="logout()">Log Out</button>
  </div>
</header>

<h1>Biji Kopi Roasted</h1>
<p class="desc">Informasi lengkap mengenai biji kopi roasted dari berbagai daerah di Indonesia.</p>

<div id="produkList" class="container"></div>

<div style="text-align:center">
  <a class="btn-back" href="2dashboard_internal.html" onclick="resetEdit()">← Kembali ke Dashboard</a>
</div>

<!-- === Tambahan Integrasi Firebase === -->
<script type="module">
  import { db } from "./firebase-init.js";
  import { ref, onValue, remove } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-database.js";

  const list = document.getElementById("produkList");
  const dataRef = ref(db, "produk/");

  onValue(dataRef, (snapshot) => {
    const data = snapshot.val();
    list.innerHTML = ""; // Kosongkan tampilan sebelumnya

    if (!data) {
      list.innerHTML = `<p style="text-align:center;color:#777;">Belum ada produk biji kopi roasted.</p>`;
      return;
    }

    // Hapus data Firebase sebelumnya agar tidak dobel
    const existingFirebaseCards = document.querySelectorAll(".card.firebase");
    existingFirebaseCards.forEach(el => el.remove());

    // Filter produk dengan kategori "Biji Kopi Roasted"
    const roastedData = Object.entries(data).filter(([id, p]) => p.jenis === "Biji Kopi Roasted");

    // Tambahkan produk dari Firebase
    roastedData.forEach(([id, p]) => {
      const div = document.createElement("div");
      div.className = "card firebase";
      div.innerHTML = `
        <h3>${p.nama || "-"}</h3>
        <p><b>Asal:</b> ${p.asal || "-"}</p>
        <p><b>Grade:</b> ${p.grade || "-"}</p>
        <p><b>Harga:</b> Rp ${Number(p.harga || 0).toLocaleString()}</p>
        ${p.gambarProfil ? `<img src="${p.gambarProfil}" alt="${p.nama}">` : ""}
        <div class="btn-group">
          <button class="btn-edit" onclick="editProduk('${id}')">Edit</button>
          <button class="btn-delete" onclick="hapusProduk('${id}')">Hapus</button>
          <button class="btn-detail" onclick="lihatDetailFirebase('${id}')">Lihat Detail</button>
        </div>
      `;
      list.appendChild(div);
    });
  });

  // Fungsi edit produk → buka form input dengan ID produk
  window.editProduk = function(id) {
    sessionStorage.setItem("produkEditId", id);
    window.location.href = "3form_input.html";
  };

  // Fungsi hapus produk dari Firebase
  window.hapusProduk = async function(id) {
    if (confirm("Apakah Anda yakin ingin menghapus produk ini?")) {
      await remove(ref(db, "produk/" + id));
      alert("Produk berhasil dihapus dari Firebase!");
    }
  };

  // fungsi untuk buka halaman detail versi Firebase
  window.lihatDetailFirebase = function(id) {
    localStorage.setItem("produkId", id);
    localStorage.setItem("lastPage", "int_roasted.html");
    window.location.href = "detail_produk_dinamis.html";
  };
</script>
<!-- === Akhir Tambahan Integrasi Firebase === -->

<script>
function navigateToInput() {
  window.location.href = "3form_input.html";
}
function logout() {
  alert("Anda telah logout.");
  window.location.href = "index.html";
}
</script>

</body>
</html>

