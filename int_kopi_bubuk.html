<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Halaman Produk Kopi Bubuk</title>
<style>
body{
  font-family:"Arial",sans-serif;
  margin:0;
  padding:0;
  background:#faf7f3;
  color:#3e2723;
}
h1{text-align:center;color:#6b4226;}
p.desc{text-align:center;color:#5d4037;}
.card{
  background:white;
  padding:5px 20px 20px 20px;
  border-radius:10px;
  box-shadow:0 3px 10px rgba(0,0,0,0.1);
  margin:10px 0;
  transition:transform 0.15s,box-shadow 0.2s;
  max-width:400px;
  text-align:center;
  max-width: 320px;
  min-height: 400px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}
.container{
  display:grid !important;
  grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
  gap:20px !important;
  padding:20px !important;
}
.card img {
  width: 100%;
  height: 200px;
  object-fit: cover;
  border-radius: 10px;
}
.card:hover{
  transform:translateY(-3px);
  box-shadow:0 5px 15px rgba(0,0,0,0.15);
}
.btn-back{
  position:absolute;
  top:80px;
  left:30px;
  background:#6b4226;
  color:white;
  padding:8px 16px;
  border-radius:5px;
  text-decoration:none;
  font-size:14px;
  transition:background 0.2s;
}
.btn-back:hover{background:#4e342e;}
#produkList{max-width:800px;margin:30px auto;}
header{
  background-color:#7b4a27;
  color:#fff !important;
  padding:14px 24px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin:0;
}
header img{height:42px;margin-right:12px;}
header .left{display:flex;align-items:center;gap:0px;}
header h1{margin:0;font-size:18px;color:#fff !important;}

header .right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.btn-header {
  background: rgba(255, 255, 255, 0.15);
  border: none;
  color: #fff;
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s;
}

.btn-header:hover {
  background: rgba(255, 255, 255, 0.3);
}

.btn-edit,.btn-delete,.btn-detail{
  border:none;
  border-radius:6px;
  padding:6px 10px;
  cursor:pointer;
  color:#fff;
  font-size:13px;
  margin-right:6px;
}
.btn-edit{background-color:#8b5e3c;}
.btn-edit:hover{background-color:#a4714e;}
.btn-delete{background-color:#c0392b;}
.btn-delete:hover{background-color:#e74c3c;}
.btn-detail{background-color:#a0522d;}
.btn-detail:hover{background-color:#f4a460;}
.btn-group{margin-top:10px;}
</style>
</head>
<body>
<header>
  <div class="left">
    <img src="https://www.gochambers.com/wp-content/uploads/2022/08/logo-6.png" alt="Logo AEKI AICE"/>
    <h1>Portal Informasi Kopi Indonesia</h1>
  </div>

  <div class="right">
    <button class="btn-header" onclick="navigateToInput()">Input</button>
    <button class="btn-header" onclick="logout()">Log Out</button>
  </div>
</header>

<h1>Kopi Bubuk</h1>
<p class="desc">Informasi lengkap mengenai kopi bubuk dari berbagai daerah di Indonesia.</p>

<div id="produkList" class="container"></div>

<div style="text-align:center">
  <a class="btn-back" href="2dashboard_internal.html" onclick="resetEdit()">← Kembali ke Dashboard</a>
</div>

<script>
const LS_KEY = 'produkKopiLengkap_v3';
let data = JSON.parse(localStorage.getItem(LS_KEY) || '[]');
const list = document.getElementById('produkList');

// Render daftar produk
function renderList(){
  list.innerHTML = '';
  const bubuk = data.filter(p => p.jenis === 'Kopi Bubuk');
  if(!bubuk.length){
    list.innerHTML = '<p style="text-align:center;color:#777;">Belum ada produk kopi bubuk.</p>';
    return;
  }
  bubuk.forEach((p,i)=>{
    const div=document.createElement('div');
    div.className='card';
    div.innerHTML=`
      <h3>${p.nama}</h3>
      <p><b>Asal:</b> ${p.asal}</p>
      <p><b>Grade:</b> ${p.grade}</p>
      <p><b>Harga:</b> Rp ${Number(p.harga||0).toLocaleString()}</p>
      ${p.gambarProfil?`<img src="${p.gambarProfil}" alt="Gambar Produk">`:''}
      <div class="btn-group">
        <button class="btn-edit" onclick="editProduk(${i})">Edit</button>
        <button class="btn-delete" onclick="hapusProduk(${i})">Hapus</button>
        <button class="btn-detail" onclick="lihatDetail(${i})">Lihat Detail</button>
      </div>`;
    list.appendChild(div);
  });
}

// Edit Produk
function editProduk(index){
  const bubuk = data.filter(p => p.jenis === 'Kopi Bubuk');
  const produk = bubuk[index];
  if (produk) {
    const allIndex = data.indexOf(produk);
    localStorage.setItem('produkEdit', JSON.stringify(produk));
    localStorage.setItem('produkEditIndex', allIndex);
    localStorage.setItem('editMode', 'true');
    window.location.href = '3form_input.html';
  }
}

// Hapus Produk
function hapusProduk(index){
  if(confirm("Apakah Anda yakin ingin menghapus produk ini?")){
    const bubuk = data.filter(p => p.jenis === 'Kopi Bubuk');
    const target = bubuk[index];
    data = data.filter(p => p !== target);
    localStorage.setItem(LS_KEY, JSON.stringify(data));
    renderList();
  }
}

// Lihat Detail Produk
function lihatDetail(index){
  const bubuk = data.filter(p => p.jenis === 'Kopi Bubuk');
  const produk = bubuk[index];
  if(produk){
    localStorage.setItem('produkDetail', JSON.stringify(produk));
    localStorage.setItem('lastPage', 'int_kopi_bubuk.html');
    window.location.href = 'detail_produk_dinamis.html';
  }
}

// Reset mode edit agar form kosong saat kembali ke dashboard
function resetEdit(){
  localStorage.removeItem('produkEdit');
  localStorage.removeItem('produkEditIndex');
  localStorage.removeItem('editMode');
}

function navigateToInput() {
  // arahkan ke halaman form input
  window.location.href = '3form_input.html';
}


function logout() {
  // hapus semua data sesi pengguna dan kembali ke halaman login/dashboard awal
  localStorage.removeItem('loggedInUser');
  alert('Anda telah logout.');
  window.location.href = 'index.html'; // ganti dengan halaman login/dashboard utama kamu
}


// Render awal
renderList();
</script>
</body>
</html>
