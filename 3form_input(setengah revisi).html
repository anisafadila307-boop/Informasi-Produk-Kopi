<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Input Informasi Produk Kopi Lengkap</title>
  <style>
:root{
  --brown1:#3e2723;
  --brown2:#5d4037;
  --brown3:#8d6e63;
  --light:#f6f3f0;
  --card:#fffaf7;
}
body{
  margin:0;
  font-family:"Poppins",sans-serif;
  background:var(--light);
  color:var(--brown1);
}
.container{
  max-width:960px;
  margin:auto;
  padding:30px 20px 60px;
}
h1{text-align:center;margin-bottom:10px;}
p.subtitle{text-align:center;color:var(--brown2);}
form{
  background:var(--card);
  border-radius:16px;
  box-shadow:0 6px 20px rgba(0,0,0,0.08);
  padding:24px;
  display:grid;
  gap:12px;
  margin-top:24px;
}
label{font-weight:600;font-size:14px;}
input,select,textarea{
  width:100%;padding:10px 12px;
  border:1px solid #ddd;border-radius:8px;
  font-family:inherit;font-size:14px;
}
textarea{min-height:70px;}
input[type=file]{border:none;}
button{
  background:var(--brown2);color:#fff;
  border:none;border-radius:8px;
  padding:10px 14px;font-weight:600;
  cursor:pointer;transition:0.2s;
}
button:hover{background:var(--brown3);}
.preview{max-width:100%;max-height:180px;display:block;margin-top:6px;border-radius:8px;}
.jenis-btns {.jenis-btns button.active {
  background:var(--active);
  transform:scale(1.05);
  box-shadow:0 4px 10px rgba(0,0,0,0.2);
}
  display:flex;justify-content:center;gap:10px;margin-top:8px;
}
.jenis-btns button {
  flex:1;background:var(--brown2);color:#fff;border:none;border-radius:8px;
  padding:10px 12px;cursor:pointer;transition:background 0.3s,transform 0.2s;
}
.jenis-btns button:hover{background:var(--brown3);transform:translateY(-2px);}
.jenis-btns button.active {
  background:var(--active);
  transform:scale(1.05);
  box-shadow:0 4px 10px rgba(0,0,0,0.2);
}
.back-dashboard{
  display:block;text-align:center;margin:20px auto 0;
  background:var(--brown2);color:white;text-decoration:none;
  border-radius:8px;padding:10px 16px;font-weight:600;
}
  </style>
</head>
<body>
<div class="container">
  <h1>Form Input Produk Kopi Lengkap</h1>
  <p class="subtitle">Pilih jenis kopi dan isi data lengkap di bawah</p>

  <div class="jenis-btns">
    <button type="button" onclick="setJenis('Biji Kopi Mentah')">Biji Kopi Mentah</button>
    <button type="button" onclick="setJenis('Biji Kopi Roasted')">Biji Kopi Roasted</button>
    <button type="button" onclick="setJenis('Kopi Bubuk')">Kopi Bubuk</button>
  </div>

  <form id="produkForm">
    <input type="hidden" id="jenis" />
    <div><label>Nama Produk</label><input id="nama" required placeholder="Contoh: Arabika Gayo Premium"></div>
    <div><label>Grade</label><input id="grade" placeholder="Contoh: Grade 1 / Specialty"></div>
    <div><label>Asal Daerah</label><input id="asal" placeholder="Contoh: Aceh Tengah"></div>
    <div><label>Harga (Rp./1000gr)</label><input id="harga" type="number" placeholder="Contoh: 75000"></div>

    <div id="kadarAir" style="display:none;"><label>Kadar Air (Moisture)</label><input id="moisture" type="number" step="0.1" placeholder="Contoh: 12.5"></div>
    <div id="defectValue" style="display:none;"><label>Defect Value</label><input id="defect" type="number" step="0.1" placeholder="Contoh: 5.2"></div>
    <div id="ukuranBiji" style="display:none;"><label>Ukuran Biji (Screen Size)</label><input id="ukuran" placeholder="Contoh: 17/18"></div>

    <div><label>Karakteristik Aroma</label><input id="aroma" placeholder="Contoh: floral, nutty, chocolate"></div>
    <div><label>Karakteristik Rasa</label><input id="rasa" placeholder="Contoh: sweet, fruity, bitter"></div>
    <div><label>Tingkat Keasaman</label>
      <select id="keasaman">
        <option value="">Pilih</option><option>Rendah</option><option>Sedang</option><option>Tinggi</option>
      </select></div>
    <div><label>Body (Kekentalan)</label>
      <select id="body">
        <option value="">Pilih</option><option>Ringan</option><option>Sedang</option><option>Penuh</option>
      </select></div>
    <div><label>Deskripsi</label><textarea id="deskripsi" placeholder="Tuliskan deskripsi umum produk kopi"></textarea></div>
    <div><label>Gambar Profil</label><input type="file" id="gambarProfil" accept="image/*"><img id="previewProfil" class="preview" style="display:none;"></div>
    <div><label>Gambar Background Halaman Detail</label><input type="file" id="gambarBg" accept="image/*"><img id="previewBg" class="preview" style="display:none;"></div>
    <button type="submit">Simpan Produk</button>
  </form>

  <a href="2dashboard_internal.html" class="back-dashboard" onclick="resetEdit()">← Kembali ke Dashboard</a>
</div>

<script>
const LS_KEY='produkKopiLengkap_v3';

function setJenis(j, btn){
  document.getElementById('jenis').value=j;

  // ubah warna tombol aktif
  const allBtns=document.querySelectorAll('.jenis-btns button');
  allBtns.forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');

function setJenis(j){
  document.getElementById('jenis').value=j;
  document.getElementById('kadarAir').style.display=j==='Biji Kopi Mentah'?'block':'none';
  document.getElementById('defectValue').style.display=j==='Biji Kopi Mentah'?'block':'none';
  document.getElementById('ukuranBiji').style.display=j==='Biji Kopi Mentah'?'block':'none';
}

// preview gambar
function previewImage(input,targetId){
  const file=input.files[0];const img=document.getElementById(targetId);
  if(!file){img.style.display='none';return;}
  const reader=new FileReader();
  reader.onload=e=>{img.src=e.target.result;img.style.display='block';};
  reader.readAsDataURL(file);
}
document.getElementById('gambarProfil').addEventListener('change',e=>previewImage(e.target,'previewProfil'));
document.getElementById('gambarBg').addEventListener('change',e=>previewImage(e.target,'previewBg'));

// cek apakah edit mode
const editMode=localStorage.getItem('editMode')==='true';
const editData=JSON.parse(localStorage.getItem('produkEdit')||'null');
const editIndex=localStorage.getItem('produkEditIndex');

if(editMode && editData){
  Object.keys(editData).forEach(k=>{
    if(document.getElementById(k))document.getElementById(k).value=editData[k]||'';
  });
  if(editData.jenis)setJenis(editData.jenis);
  if(editData.gambarProfil){previewProfil.src=editData.gambarProfil;previewProfil.style.display='block';}
  if(editData.gambarBg){previewBg.src=editData.gambarBg;previewBg.style.display='block';}
}else{
  resetEdit();
}

function resetEdit(){
  localStorage.removeItem('produkEdit');
  localStorage.removeItem('produkEditIndex');
  localStorage.removeItem('editMode');
}

document.getElementById('produkForm').addEventListener('submit',e=>{
  e.preventDefault();
  const jenis=document.getElementById('jenis').value;
  if(!jenis)return alert('Pilih jenis kopi terlebih dahulu!');

  const produk={
    nama:nama.value.trim(),
    jenis,grade:grade.value.trim(),asal:asal.value.trim(),
    harga:harga.value.trim(),moisture:moisture.value.trim(),
    defect:defect.value.trim(),ukuran:ukuran.value.trim(),
    deskripsi:deskripsi.value.trim(),aroma:aroma.value.trim(),
    rasa:rasa.value.trim(),keasaman:keasaman.value,body:body.value,
    gambarProfil:previewProfil.src,gambarBg:previewBg.src,tanggal:Date.now()
  };

  const data=JSON.parse(localStorage.getItem(LS_KEY)||'[]');
  if(editMode && editIndex!==null){data[editIndex]=produk;}
  else data.push(produk);
  localStorage.setItem(LS_KEY,JSON.stringify(data));

  resetEdit();
  alert('Produk berhasil disimpan!');

  if(jenis==='Biji Kopi Mentah')location.href='int_mentah.html';
  else if(jenis==='Biji Kopi Roasted')location.href='int_roasted.html';
  else location.href='int_kopi_bubuk.html';
});
</script>
</body>
</html>
